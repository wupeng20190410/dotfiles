!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("fs"),require("path"),require("chalk")):"function"==typeof define&&define.amd?define(["exports","fs","path","chalk"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).PicGo_I18n={},e.fs,e.path,e.chalk)}(this,(function(e,t,a,r){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var r=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,r.get?r:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var l,n,c,i=s(t),u=s(a),h=o(r);class f{}!function(e){e.change="change"}(l||(l={})),function(e){e.dev="development"}(n||(n={})),function(e){e.node="node",e.web="web"}(c||(c={}));const d=new class{constructor(){this.isNode=this.getPlatform()===c.node}error(e){const t=this.formatOutput(e);console.error(this.isNode?h.default.red(t):t)}log(e){const t=this.formatOutput(e);console.log(this.isNode?h.default.gray(t):t)}warn(e){const t=this.formatOutput(e);console.warn(this.isNode?h.default.yellow(t):t)}getPlatform(){return"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)?c.node:c.web}formatOutput(e){return`[i18n] ${e}`}};e.BaseAdapter=f,e.FileSyncAdapter=class extends f{constructor(e){super(),this.locales={},this.localeFileName={};const{localesBaseDir:t,localeFileName:a}=e;this.localesBaseDir=t,null!=a?this.localeFileName=a:this.guessLocaleFileName(t),process.env.NODE_ENV===n.dev&&this.watch(this.localesBaseDir)}getLocale(e){return this.locales[e]||this.loadLocale(e),this.locales[e]}loadLocale(e){if(!this.localeFileName[e])return void d.error(`can 't locate the locale file of language ${e}`);const t=u.join(this.localesBaseDir,this.localeFileName[e]),a=i.readFileSync(t,{encoding:"utf-8"});try{const t=JSON.parse(a);this.locales[e]=t}catch(e){d.error(`unable to parse locales from file (maybe ${t} is empty or invalid json?)`),d.error(`raw error info: ${e}`)}}guessLocaleFileName(e){const t=i.readdirSync(e),a={};t.forEach((e=>{const t=e.replace(u.extname(e),"");a[t]=e})),d.log(`guess locale file path from ${e}`),d.log(`localeFileName: ${JSON.stringify(a)}`),this.localeFileName=a}watch(e){i.watch(e,((e,t)=>{let a="";const{localeFileName:r}=this;for(const e in r)r.hasOwnProperty(e)&&r[e]===t&&(a=e);a&&e===l.change&&(this.loadLocale(a),d.log(`${t} has updated`))}))}},e.I18n=class{constructor(e){const{adapter:t,defaultLanguage:a}=e;this.adapter=t,this.currentLanguage=a.trim(),this.defaultLanguage=this.currentLanguage}getAdapter(){return this.adapter}getLanguage(){return this.currentLanguage}setLanguage(e){this.currentLanguage=e.trim()}setDefaultLanguage(e){this.defaultLanguage=e.trim()}getLocale(){let e=this.adapter.getLocale(this.currentLanguage);if(!e){if(e=this.adapter.getLocale(this.defaultLanguage),!e)return d.error(`current locale ${this.currentLanguage} is null`),null;d.error(`current locale ${this.currentLanguage} is null, change to default locale ${this.defaultLanguage}`)}return e}translate(e,t){const a=this.getLocale();if(!a)return;const r=e.split(".").reduce(((t,a)=>{if(t&&t.hasOwnProperty(a))return t[a];d.warn(`current locale doesn't contain ${e}`)}),a);return this.postProcess(r,t)}postProcess(e,t){if(e)return t?Object.keys(t).reduce(((e,a)=>e.replace("${"+a+"}",t[a])),e):e}},e.ObjectAdapter=class extends f{constructor(e){super(),this.locales={},this.locales=e}getLocale(e){return this.locales[e]}setLocales(e){this.locales=e}setLocale(e,t){this.locales[e]=t}},e.logger=d,Object.defineProperty(e,"__esModule",{value:!0})}));
